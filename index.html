<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentor de Líderes - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            overflow-x: hidden !important;
            width: 100%;
            position: relative;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            color: #e4e4e4;
            overflow-x: hidden !important;
            width: 100%;
            position: relative;
        }

        .container {
            width: 100% !important;
            max-width: 100% !important;
            margin: 0 auto;
            padding: 0 5px !important;
            box-sizing: border-box;
            overflow-x: hidden !important;
        }

        /* Logo e Header */
        .brand-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 30px 25px;
            background: rgba(45, 45, 68, 0.3);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .logo-container {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            background: white;
            border-radius: 50%;
            padding: 0;
            box-shadow: 0 10px 40px rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid rgba(13, 202, 240, 0.3);
        }

        .logo-lion {
            font-size: 70px;
            line-height: 1;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
        }

        .brand-title {
            font-size: 3em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .brand-subtitle {
            font-size: 1.4em;
            color: #b8b8b8;
            font-weight: 300;
        }

        /* Login Card */
        .login-card {
            background: rgba(45, 45, 68, 0.5);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 600px !important;
            margin: 0 auto !important;
        }

        .dashboard-card {
            background: rgba(45, 45, 68, 0.5);
            border-radius: 20px;
            padding: 20px 5px !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
            margin: 0 auto;
        }

        #masterContent {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #e4e4e4;
            font-weight: 600;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            font-size: 1em;
            color: white;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #0dcaf0;
            background: rgba(255,255,255,0.15);
        }

        .input-group input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .btn-primary {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(13, 202, 240, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .link-button {
            text-align: center;
            margin-top: 15px;
        }

        .link-button a {
            color: #0dcaf0;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }

        .link-button a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        /* Messages */
        .error-message, .success-message, .info-message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid;
        }

        .error-message {
            background: rgba(220, 53, 69, 0.2);
            border-color: #dc3545;
            color: #ff6b6b;
        }

        .success-message {
            background: rgba(40, 167, 69, 0.2);
            border-color: #28a745;
            color: #51cf66;
        }

        .info-message {
            background: rgba(13, 202, 240, 0.2);
            border-color: #0dcaf0;
            color: #0dcaf0;
        }

        /* Dashboard Header */
        .dashboard-header {
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 20px rgba(13, 202, 240, 0.2);
        }

        .dashboard-header h2 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .dashboard-header p {
            opacity: 0.9;
            font-size: 1em;
        }

        .badge-master {
            background: rgba(255,255,255,0.3);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9em;
        }

        .master-header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .logout-btn-header {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn-header:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        /* Botão Editar Nome e Sair (Aluno) */
        .aluno-header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn-edit-name {
            background: rgba(255,255,255,0.1);
            color: #e4e4e4;
            padding: 8px 15px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-edit-name:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.4);
        }

        .logout-btn-aluno {
            background: rgba(255,255,255,0.1);
            color: #e4e4e4;
            padding: 8px 15px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .logout-btn-aluno:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.4);
        }

        /* Modal de Edição de Nome */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: rgba(45, 45, 68, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .modal-header {
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 1.8em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: #b8b8b8;
            font-size: 1em;
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            gap: 15px;
        }

        .btn-modal {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cancel {
            background: rgba(255,255,255,0.1);
            color: #e4e4e4;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-cancel:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-save {
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            color: white;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(13, 202, 240, 0.4);
        }

        /* Visão Estratégica */
        .strategic-section {
            margin-bottom: 30px;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
        }

        .strategic-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-subtitle {
            font-size: 1.2em;
            font-weight: 600;
            color: #0dcaf0;
            margin: 25px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .kpi-grid-strategic {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (max-width: 1200px) {
            .kpi-grid-strategic {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 700px) {
            .kpi-grid-strategic {
                grid-template-columns: 1fr;
            }
        }

        .kpi-card {
            background: rgba(26, 26, 46, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .kpi-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #0dcaf0;
            margin: 10px 0;
        }

        .kpi-label {
            color: #b8b8b8;
            font-size: 0.9em;
        }

        .kpi-sublabel {
            color: #808080;
            font-size: 0.8em;
            margin-top: 5px;
        }

        .kpi-alert {
            border: 2px solid rgba(255, 193, 7, 0.6) !important;
            background: rgba(255, 193, 7, 0.1) !important;
        }

        .kpi-alert .kpi-value {
            color: #ffc107 !important;
        }

        /* Análise de Formulários - Card Dinâmico */
        .analise-formularios-section {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(13, 202, 240, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
        }

        .analise-header {
            margin-bottom: 20px;
        }

        .analise-header label {
            color: #ffffff;
            font-weight: 600;
            display: block;
            margin-bottom: 10px;
        }

        .select-formulario {
            width: 100%;
            padding: 12px;
            background: rgba(45, 45, 68, 0.8);
            border: 1px solid rgba(13, 202, 240, 0.3);
            border-radius: 8px;
            color: #ffffff;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .select-formulario:hover {
            border-color: rgba(13, 202, 240, 0.6);
            background: rgba(45, 45, 68, 1);
        }

        .select-formulario:focus {
            outline: none;
            border-color: #0dcaf0;
        }

        .analise-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .analise-stat-turma {
            background: rgba(45, 45, 68, 0.6);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .analise-stat-turma h4 {
            color: #0dcaf0;
            margin: 0 0 12px 0;
            font-size: 1em;
        }

        .stat-big {
            font-size: 2em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .stat-percent {
            font-size: 1.4em;
            font-weight: 600;
            color: #0dcaf0;
            margin-bottom: 12px;
        }

        .progress-bar-large {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill-large {
            height: 100%;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            transition: width 0.5s ease;
        }

        .analise-detalhes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .analise-coluna h5 {
            color: #0dcaf0;
            margin: 0 0 15px 0;
            font-size: 1em;
            font-weight: 700;
        }

        .analise-grupo {
            margin-bottom: 20px;
        }

        .grupo-title {
            color: #ffffff;
            font-size: 0.9em;
            font-weight: 600;
            margin: 0 0 10px 0;
        }

        .chips-scroll {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 150px;
            overflow-y: auto;
            padding: 2px;
        }

        .chips-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .chips-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .chips-scroll::-webkit-scrollbar-thumb {
            background: rgba(13, 202, 240, 0.5);
            border-radius: 3px;
        }

        .chip-nome {
            background: rgba(13, 202, 240, 0.2);
            color: #0dcaf0;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            border: 1px solid rgba(13, 202, 240, 0.3);
            white-space: nowrap;
        }

        .chip-nome.pendente {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border-color: rgba(255, 193, 7, 0.3);
        }

        .empty-msg {
            color: #888;
            font-size: 0.9em;
            font-style: italic;
        }

        @media (max-width: 900px) {
            .analise-stats,
            .analise-detalhes {
                grid-template-columns: 1fr;
            }
        }

        .comparison-table {
            width: 100% !important;
            max-width: 100% !important;
            background: rgba(26, 26, 46, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
            box-sizing: border-box;
        }

        .comparison-table table {
            width: 100% !important;
            border-collapse: collapse;
        }

        .comparison-table tr {
            width: 100% !important;
        }

        .comparison-table td {
            width: 100% !important;
            max-width: 100% !important;
        }

        .comparison-table th {
            background: rgba(13, 202, 240, 0.2);
            color: #ffffff;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: #e4e4e4;
        }

        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .comparison-table th:nth-child(2),
        .comparison-table th:nth-child(3),
        .comparison-table td:nth-child(2),
        .comparison-table td:nth-child(3) {
            text-align: center;
        }

        .progress-bar-mini {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill-mini {
            height: 100%;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            transition: width 0.3s;
        }

        .insight-box {
            background: rgba(13, 202, 240, 0.1);
            border-left: 4px solid #0dcaf0;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 15px;
        }

        .insight-box h4 {
            color: #0dcaf0;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .insight-box p {
            color: #e4e4e4;
            line-height: 1.6;
            margin: 5px 0;
        }

        .risk-badge {
            background: rgba(255, 59, 48, 0.2);
            color: #ff3b30;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .success-badge {
            background: rgba(52, 199, 89, 0.2);
            color: #34c759;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .gap-indicator {
            font-size: 0.85em;
            font-weight: 600;
        }

        .gap-positive {
            color: #34c759;
        }

        .gap-negative {
            color: #ff3b30;
        }

        /* Drill-down de Formulários */
        .formulario-row {
            cursor: pointer;
            transition: background 0.2s;
        }

        .formulario-row:hover {
            background: rgba(13, 202, 240, 0.05) !important;
        }

        .formulario-row.expanded {
            background: rgba(13, 202, 240, 0.1) !important;
        }

        .expand-icon-table {
            display: inline-block;
            margin-left: 10px;
            transition: transform 0.3s;
            color: #0dcaf0;
            font-weight: bold;
        }

        .expanded .expand-icon-table {
            transform: rotate(180deg);
        }

        .formulario-details {
            display: none;
        }

        .formulario-details.active {
            display: block;
            width: 100% !important;
        }

        .formulario-details td {
            width: 100% !important;
            max-width: 100% !important;
        }

        .formulario-details-content {
            padding: 20px 5px !important;
            background: rgba(26, 26, 46, 0.3);
            border-left: 4px solid #0dcaf0;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .turmas-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px !important;
            margin-top: 15px;
            width: 95% !important;
            max-width: 1400px !important;
            padding: 0;
            box-sizing: border-box;
        }

        /* ==================== NOVOS ESTILOS MASTER ==================== */
        
        /* SEÇÃO 1: Estatísticas por Formulário */
        .formularios-stats-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .form-stat-card {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(13, 202, 240, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .form-stat-title {
            color: #ffffff;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .form-stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-stat-turma {
            background: rgba(45, 45, 68, 0.6);
            padding: 15px;
            border-radius: 10px;
        }

        .form-stat-label {
            color: #0dcaf0;
            font-size: 0.85em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .form-stat-value {
            color: #ffffff;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .form-stat-percent {
            color: #0dcaf0;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .form-stat-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .form-stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            transition: width 0.5s ease;
        }

        /* SEÇÃO 2: Detalhamento por Formulário */
        .formularios-detalhes-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .form-detail-card {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(13, 202, 240, 0.2);
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .form-detail-header {
            padding: 18px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .form-detail-header:hover {
            background: rgba(13, 202, 240, 0.1);
        }

        .form-detail-header h4 {
            color: #ffffff;
            font-size: 1.1em;
            margin: 0;
        }

        .form-detail-header .expand-icon {
            color: #0dcaf0;
            transition: transform 0.3s;
        }

        .form-detail-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .form-detail-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .form-detail-card.expanded .form-detail-content {
            max-height: 2000px;
        }

        .form-detail-turmas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        .form-detail-turma {
            background: rgba(45, 45, 68, 0.6);
            padding: 15px;
            border-radius: 10px;
        }

        .turma-title {
            color: #0dcaf0;
            font-size: 1em;
            margin: 0 0 15px 0;
            font-weight: 700;
        }

        .form-detail-section {
            margin-bottom: 15px;
        }

        .section-title-small {
            color: #ffffff;
            font-size: 0.9em;
            margin: 0 0 10px 0;
            font-weight: 600;
        }

        .alunos-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .aluno-chip {
            background: rgba(13, 202, 240, 0.2);
            color: #0dcaf0;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            border: 1px solid rgba(13, 202, 240, 0.3);
        }

        .aluno-chip.pendente {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border-color: rgba(255, 193, 7, 0.3);
        }

        .empty-text {
            color: #888;
            font-size: 0.9em;
            font-style: italic;
        }

        /* SEÇÃO 3: Distribuição de Arquétipos */
        .arquetipos-stats-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .arquetipos-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .arquetipo-turma-card {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(13, 202, 240, 0.2);
            border-radius: 12px;
            padding: 20px;
        }

        .arquetipo-turma-title {
            color: #0dcaf0;
            font-size: 1.1em;
            margin: 0 0 20px 0;
            font-weight: 700;
        }

        .arquetipos-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .arquetipo-item-stat {
            background: rgba(45, 45, 68, 0.6);
            padding: 12px;
            border-radius: 8px;
        }

        .arquetipo-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .arquetipo-nome-stat {
            color: #ffffff;
            font-size: 0.95em;
            font-weight: 600;
        }

        .arquetipo-count {
            color: #0dcaf0;
            font-size: 0.9em;
            font-weight: 600;
        }

        .arquetipo-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .arquetipo-fill {
            height: 100%;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            transition: width 0.5s ease;
        }

        @media (max-width: 900px) {
            .form-stat-grid,
            .form-detail-turmas,
            .arquetipos-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 900px) {
            .turmas-comparison {
                grid-template-columns: 1fr;
            }
        }

        .turma-alunos-box {
            background: rgba(45, 45, 68, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px !important;
            min-height: 500px;
            width: 100% !important;
            max-width: 100% !important;
        }

        .turma-alunos-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px !important;
            margin-top: 15px;
            width: 100% !important;
        }

        .alunos-section {
            max-height: 650px;
            overflow-y: auto;
            padding-right: 10px;
            width: 100% !important;
        }

        .alunos-section::-webkit-scrollbar {
            width: 8px;
        }

        .alunos-section::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .alunos-section::-webkit-scrollbar-thumb {
            background: rgba(13, 202, 240, 0.5);
            border-radius: 4px;
        }

        .alunos-section::-webkit-scrollbar-thumb:hover {
            background: rgba(13, 202, 240, 0.8);
        }

        @media (max-width: 700px) {
            .turma-alunos-content {
                grid-template-columns: 1fr;
            }
        }

        .turma-alunos-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #0dcaf0;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .alunos-section-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: sticky;
            top: 0;
            background: rgba(45, 45, 68, 0.95);
            padding: 8px 0;
            z-index: 1;
        }

        .alunos-section-title.preenchidos {
            color: #34c759;
        }

        .alunos-section-title.pendentes {
            color: #ffc107;
        }

        .aluno-item {
            padding: 12px 15px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            font-size: 1em;
            color: #e4e4e4;
            transition: all 0.2s;
        }

        .aluno-item:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateX(5px);
        }

        .aluno-item-email {
            font-size: 0.9em;
            color: #b8b8b8;
            margin-top: 5px;
        }

        .empty-list {
            color: #808080;
            font-style: italic;
            padding: 10px;
            text-align: center;
        }

        /* Progress Section */
        .progress-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .progress-header h3 {
            font-size: 1.1em;
        }

        .progress-percentage {
            font-size: 1.5em;
            font-weight: 700;
            color: #0dcaf0;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 600;
        }

        /* Section Titles */
        .section-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #ffffff;
            margin: 40px 0 20px;
            padding-left: 15px;
            border-left: 5px solid #0dcaf0;
        }

        /* Biblioteca de Recursos */
        .biblioteca-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .biblioteca-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .biblioteca-icon {
            font-size: 2.5em;
        }

        .biblioteca-title {
            font-size: 1.8em;
            font-weight: 700;
            color: #0dcaf0;
        }

        .recursos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .recurso-card {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.8) 0%, rgba(36, 36, 66, 0.6) 100%);
            border: 2px solid rgba(13, 202, 240, 0.3);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .recurso-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0dcaf0 0%, #0ba8cc 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .recurso-card:hover::before {
            opacity: 1;
        }

        .recurso-card:hover {
            transform: translateY(-8px);
            border-color: rgba(13, 202, 240, 0.6);
            box-shadow: 0 15px 40px rgba(13, 202, 240, 0.3);
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.9) 0%, rgba(36, 36, 66, 0.8) 100%);
        }

        .recurso-header {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 18px;
        }

        .recurso-icon {
            font-size: 3em;
            min-width: 60px;
            text-align: center;
            filter: drop-shadow(0 2px 8px rgba(13, 202, 240, 0.3));
        }

        .recurso-info {
            flex: 1;
        }

        .recurso-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .recurso-descricao {
            color: #c0c0c0;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 18px;
        }

        .recurso-categoria {
            display: inline-block;
            background: rgba(13, 202, 240, 0.25);
            color: #0dcaf0;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 18px;
            border: 1px solid rgba(13, 202, 240, 0.4);
        }

        .btn-download {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(13, 202, 240, 0.5);
            background: linear-gradient(135deg, #1fd4ff 0%, #0dcaf0 100%);
        }

        .empty-biblioteca {
            text-align: center;
            padding: 60px 20px;
            color: #b8b8b8;
        }

        .empty-biblioteca-icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Acesso Rápido */
        .acesso-rapido-section {
            background: rgba(45, 45, 68, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .acesso-rapido-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .acesso-rapido-icon {
            font-size: 1.8em;
        }

        .acesso-rapido-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #0dcaf0;
            margin: 0;
        }

        /* Botão Plataforma de Vídeos */
        .btn-plataforma-videos {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            padding: 20px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-decoration: none;
            color: white;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .btn-plataforma-videos:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(13, 202, 240, 0.4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .btn-plataforma-videos .btn-icon {
            font-size: 2em;
        }

        .btn-plataforma-videos .btn-text {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .btn-plataforma-videos strong {
            font-size: 1.1em;
        }

        .btn-plataforma-videos small {
            opacity: 0.9;
            font-size: 0.9em;
        }

        .btn-plataforma-videos .btn-arrow {
            font-size: 1.5em;
            font-weight: bold;
        }

        /* Agendamento */
        .agendamento-section {
            background: rgba(26, 26, 46, 0.5);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .agendamento-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .agendamento-icon {
            font-size: 1.5em;
        }

        .agendamento-header h4 {
            font-size: 1.1em;
            font-weight: 600;
            color: #ffffff;
            margin: 0;
        }

        .mentores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .btn-mentor {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(45, 45, 68, 0.7);
            padding: 15px 18px;
            border-radius: 10px;
            text-decoration: none;
            color: white;
            transition: all 0.3s;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .btn-mentor:hover {
            background: rgba(13, 202, 240, 0.2);
            border-color: rgba(13, 202, 240, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(13, 202, 240, 0.2);
        }

        .btn-mentor .mentor-icon {
            font-size: 1.3em;
        }

        .btn-mentor .mentor-nome {
            flex: 1;
            font-weight: 600;
            font-size: 0.95em;
        }

        .btn-mentor .mentor-arrow {
            font-size: 1.2em;
            opacity: 0.7;
        }

        /* Formulários */
        .formularios-grid {
            display: grid;
            gap: 20px;
        }

        .formulario-card {
            background: rgba(45, 45, 68, 0.5);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
        }

        .formulario-card:hover {
            transform: translateY(-5px);
            border-color: rgba(13, 202, 240, 0.5);
            box-shadow: 0 10px 30px rgba(13, 202, 240, 0.2);
        }

        .formulario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .formulario-title {
            font-size: 1.2em;
            font-weight: 600;
        }

        .status-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .status-preenchido {
            background: rgba(40, 167, 69, 0.3);
            color: #51cf66;
            border: 1px solid #51cf66;
        }

        .status-pendente {
            background: rgba(220, 53, 69, 0.3);
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
        }

        .btn-formulario {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-preencher {
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            color: white;
        }

        .btn-preencher:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(13, 202, 240, 0.4);
        }

        .btn-concluido {
            background: rgba(40, 167, 69, 0.3);
            color: #51cf66;
            cursor: default;
            border: 1px solid #51cf66;
        }

        /* Master Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(45, 45, 68, 0.5);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(13, 202, 240, 0.5);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #0dcaf0;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #b8b8b8;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(45, 45, 68, 0.5);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: #e4e4e4;
        }

        .tab.active {
            background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
            border-color: #0dcaf0;
            color: white;
        }

        .tab:hover {
            transform: translateY(-2px);
            border-color: rgba(13, 202, 240, 0.5);
        }

        /* Aluno Card Expandível */
        .aluno-card {
            background: rgba(45, 45, 68, 0.5);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-bottom: 15px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .aluno-card:hover {
            border-color: rgba(13, 202, 240, 0.5);
        }

        .aluno-header {
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .aluno-info {
            flex: 1;
        }

        .aluno-nome {
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .aluno-email {
            color: #b8b8b8;
            font-size: 0.9em;
        }

        .aluno-stats {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .mini-progress {
            font-size: 0.9em;
            color: #0dcaf0;
            font-weight: 600;
        }

        .expand-icon {
            font-size: 1.5em;
            color: #0dcaf0;
            transition: transform 0.3s;
        }

        .aluno-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .aluno-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: rgba(26, 26, 46, 0.5);
        }

        .aluno-card.expanded .aluno-details {
            max-height: 1000px;
        }

        .formularios-table {
            width: 100%;
            margin: 20px;
        }

        .formularios-table table {
            width: calc(100% - 40px);
            border-collapse: collapse;
        }

        .formularios-table th {
            text-align: left;
            padding: 12px;
            background: rgba(13, 202, 240, 0.2);
            border-bottom: 2px solid #0dcaf0;
            color: #0dcaf0;
            font-weight: 600;
        }

        .formularios-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .formularios-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        .status-icon {
            font-size: 1.2em;
        }

        .logout-btn {
            background: rgba(255,255,255,0.1);
            color: #e4e4e4;
            padding: 10px 20px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.4);
        }

        .password-strength {
            height: 5px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: all 0.3s;
        }

        .strength-weak { background: #dc3545; }
        .strength-medium { background: #ffc107; }
        .strength-strong { background: #28a745; }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                text-align: center;
            }

            .aluno-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .aluno-stats {
                width: 100%;
                justify-content: space-between;
            }

            .brand-title {
                font-size: 2em;
            }

            .logo-container {
                width: 100px;
                height: 100px;
            }

            .logo-lion {
                font-size: 60px;
            }

            .brand-subtitle {
                font-size: 1.1em;
            }

            .recursos-grid {
                grid-template-columns: 1fr;
            }

            .master-header-actions {
                flex-direction: column;
                gap: 10px;
            }

            .logout-btn-header {
                width: 100%;
            }
        }
        /* ==================== SEÇÃO ARQUÉTIPO ==================== */

.arquetipo-section {
    background: rgba(45, 45, 68, 0.5);
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 20px;
    border: 1px solid rgba(255,255,255,0.1);
}

.arquetipo-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(13, 202, 240, 0.3);
}

.arquetipo-icon-header {
    font-size: 1.4em;
}

.arquetipo-title-main {
    font-size: 1.1em;
    font-weight: 700;
    color: #0dcaf0;
    margin: 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.arquetipo-card {
    background: linear-gradient(135deg, rgba(26, 26, 46, 0.8) 0%, rgba(26, 26, 46, 0.4) 100%);
    border: 2px solid rgba(13, 202, 240, 0.3);
    border-radius: 12px;
    padding: 15px;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
}

.arquetipo-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(13, 202, 240, 0.1) 0%, transparent 70%);
    animation: rotate 10s linear infinite;
}

@keyframes rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.arquetipo-card-content {
    position: relative;
    z-index: 1;
    text-align: center;
}

.arquetipo-emoji {
    font-size: 2.5em;
    margin-bottom: 8px;
}

.arquetipo-nome {
    font-size: 1.2em;
    font-weight: 900;
    color: #ffffff;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 0 10px rgba(13, 202, 240, 0.5);
}

.arquetipo-frase {
    font-size: 0.9em;
    font-style: italic;
    color: #0dcaf0;
    margin-bottom: 15px;
    line-height: 1.4;
    font-weight: 500;
}

.arquetipo-detalhes {
    display: grid;
    gap: 10px;
    margin-bottom: 15px;
    text-align: left;
}

.arquetipo-item {
    background: rgba(45, 45, 68, 0.6);
    padding: 10px;
    border-radius: 8px;
    border-left: 3px solid #0dcaf0;
    transition: all 0.3s;
}

.arquetipo-item:hover {
    background: rgba(45, 45, 68, 0.8);
    transform: translateX(3px);
    border-left-color: #ffffff;
}

.arquetipo-label {
    display: block;
    font-size: 0.8em;
    font-weight: 700;
    color: #0dcaf0;
    margin-bottom: 5px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.arquetipo-texto {
    font-size: 0.85em;
    color: #e4e4e4;
    line-height: 1.4;
    margin: 0;
}

.btn-download-arquetipo {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: linear-gradient(135deg, #0dcaf0 0%, #0ba8cc 100%);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 0.9em;
    font-weight: 700;
    text-decoration: none;
    transition: all 0.3s;
    border: 2px solid transparent;
    box-shadow: 0 3px 12px rgba(13, 202, 240, 0.3);
}

.btn-download-arquetipo:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 6px 20px rgba(13, 202, 240, 0.5);
    border-color: rgba(255, 255, 255, 0.3);
}

.btn-download-arquetipo .btn-icon {
    font-size: 1.1em;
}

/* Responsivo */
@media (max-width: 768px) {
    .arquetipo-section {
        padding: 20px;
    }
    
    .arquetipo-card {
        padding: 25px;
    }
    
    .arquetipo-emoji {
        font-size: 4em;
    }
    
    .arquetipo-nome {
        font-size: 1.8em;
    }
    
    .arquetipo-frase {
        font-size: 1.1em;
    }
    
    .btn-download-arquetipo {
        padding: 15px 25px;
        font-size: 1em;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo e Header -->
        <div class="brand-header">
            <div class="logo-container">
                <div class="logo-lion">🦁</div>
            </div>
            <h1 class="brand-title">Mentor de Líderes</h1>
            <p class="brand-subtitle">Transformando Potencial em Liderança</p>
        </div>

        <!-- Tela de Login -->
        <div id="loginScreen">
            <div class="login-card">
                <div id="loginMessage"></div>
                <form id="loginForm">
                    <div class="input-group">
                        <label for="emailInput">Email</label>
                        <input type="email" id="emailInput" placeholder="seu@email.com" required>
                    </div>
                    <div class="input-group">
                        <label for="senhaInput">Senha</label>
                        <input type="password" id="senhaInput" placeholder="Digite sua senha" required>
                    </div>
                    <button type="submit" class="btn-primary" id="btnLogin">Entrar</button>
                </form>
                <div class="link-button">
                    <a id="linkEsqueciSenha">Esqueci minha senha</a>
                </div>
            </div>
        </div>

        <!-- Tela de Recuperação de Senha -->
        <div id="recuperarSenhaScreen" class="hidden">
            <div class="login-card">
                <div id="recuperarMessage"></div>
                <form id="recuperarForm">
                    <div class="input-group">
                        <label for="emailRecuperar">Email</label>
                        <input type="email" id="emailRecuperar" placeholder="seu@email.com" required>
                    </div>
                    <button type="submit" class="btn-primary" id="btnRecuperar">Recuperar Senha</button>
                </form>
                <div class="link-button">
                    <a id="linkVoltarLogin">Voltar para o login</a>
                </div>
            </div>
        </div>

        <!-- Tela de Redefinir Senha -->
        <div id="redefinirSenhaScreen" class="hidden">
            <div class="login-card">
                <div id="redefinirMessage"></div>
                <form id="redefinirForm">
                    <div class="input-group">
                        <label for="codigoRecuperacao">Código de Recuperação</label>
                        <input type="text" id="codigoRecuperacao" placeholder="Digite o código recebido" required>
                    </div>
                    <div class="input-group">
                        <label for="novaSenha">Nova Senha</label>
                        <input type="password" id="novaSenha" placeholder="Digite a nova senha" required>
                        <div class="password-strength">
                            <div class="password-strength-bar" id="strengthBar"></div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="confirmarSenha">Confirmar Nova Senha</label>
                        <input type="password" id="confirmarSenha" placeholder="Confirme a nova senha" required>
                    </div>
                    <button type="submit" class="btn-primary" id="btnRedefinir">Redefinir Senha</button>
                </form>
                <div class="link-button">
                    <a id="linkVoltarLogin2">Voltar para o login</a>
                </div>
            </div>
        </div>

        <!-- Tela de Primeiro Acesso -->
        <div id="primeiroAcessoScreen" class="hidden">
            <div class="login-card">
                <h2 style="text-align: center; margin-bottom: 20px;">🎉 Bem-vindo(a)!</h2>
                <div id="primeiroAcessoMessage"></div>
                <form id="primeiroAcessoForm">
                    <div class="input-group">
                        <label for="nomePreferidoInput">Como gostaria de ser chamado(a)?</label>
                        <input type="text" id="nomePreferidoInput" placeholder="Digite seu nome preferido" required>
                    </div>
                    <div class="input-group">
                        <label for="novaSenhaPrimeiroAcesso">Crie sua senha</label>
                        <input type="password" id="novaSenhaPrimeiroAcesso" placeholder="Digite sua nova senha" required>
                        <div class="password-strength">
                            <div class="password-strength-bar" id="strengthBarPrimeiroAcesso"></div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="confirmarSenhaPrimeiroAcesso">Confirme sua senha</label>
                        <input type="password" id="confirmarSenhaPrimeiroAcesso" placeholder="Confirme sua nova senha" required>
                    </div>
                    <button type="submit" class="btn-primary" id="btnPrimeiroAcesso">Continuar</button>
                </form>
            </div>
        </div>

        <!-- Dashboard do Aluno -->
        <div id="dashboardScreen" class="hidden">
            <div class="dashboard-card">
                <div id="dashboardContent"></div>
            </div>
        </div>

        <!-- Dashboard Master -->
        <div id="masterDashboard" class="hidden">
            <div class="dashboard-card">
                <div id="masterContent"></div>
            </div>
        </div>
    </div>

    <!-- Modal de Edição de Nome -->
    <div id="modalEditarNome" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">✏️ Editar Nome Preferido</h3>
                <p class="modal-subtitle">Como você gostaria de ser chamado(a)?</p>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="novoNomePreferido">Nome Preferido</label>
                    <input type="text" id="novoNomePreferido" placeholder="Digite seu nome preferido">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-cancel" id="btnCancelarNome">Cancelar</button>
                <button class="btn-modal btn-save" id="btnSalvarNome">Salvar</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURAÇÃO ====================
        const PLANILHA_ID = '1OjxHwWh6kWaNgQrCPP57GB_FMs4LVFH3Orbve3ciylQ';
        
        // GIDs das abas da planilha
        const ABAS = {
            TURMA_1: 1942550026,
            TURMA_2: 811800566,
            RECURSOS: 209666554,
            CONFIG: 129627600
        };
        
        // Função para gerar URL de cada aba
        const getURL = (gid) => `https://docs.google.com/spreadsheets/d/${PLANILHA_ID}/gviz/tq?tqx=out:json&gid=${gid}`;

        // ==================== DADOS DOS ARQUÉTIPOS ====================
        const ARQUETIPOS_DATA = {
            "Inocente": {
                emoji: "🕊️",
                frase: "A confiança e a otimismo são meus guias para um mundo melhor",
                forca: "Pureza de intenções, fé inabalável, capacidade de ver o bem em todas as situações",
                desafio: "Evitar a ingenuidade excessiva e desenvolver discernimento sem perder a esperança",
                missao: "Trazer luz e renovação, inspirando outros a acreditar em possibilidades positivas",
                cor: "#87ceeb",
                link: "https://drive.google.com/file/d/1BHVakykvtbOIJ_1hNamKu1XQmyNUJ90m/view"
            },
            "Mago": {
                emoji: "🔮",
                frase: "Transformo sonhos em realidade através do conhecimento e da ação",
                forca: "Visão transformadora, capacidade de materializar ideias, poder de catalizar mudanças",
                desafio: "Usar o poder com responsabilidade e não manipular outras pessoas",
                missao: "Transformar o mundo através da inovação e fazer o impossível acontecer",
                cor: "#673ab7",
                link: "https://drive.google.com/file/d/11qydMB9fQwtK_NwUqqiRBmWHo-l9OLs6/view"
            },
            "Prestativo": {
                emoji: "🤲",
                frase: "Minha força está em cuidar e servir aos outros com amor genuíno",
                forca: "Compaixão profunda, generosidade natural, capacidade de nutrir e apoiar",
                desafio: "Aprender a cuidar de si mesmo sem se esquecer de suas próprias necessidades",
                missao: "Fazer a diferença através do serviço altruísta e do cuidado com o próximo",
                cor: "#4caf50",
                link: "https://drive.google.com/file/d/12eJnI8QQZWJNxDaUdtDodXX2OeoQin9I/view"
            },
            "Sábio": {
                emoji: "📖",
                frase: "Busco a verdade e compartilho conhecimento para iluminar caminhos",
                forca: "Sabedoria profunda, pensamento analítico, busca constante pelo conhecimento",
                desafio: "Transformar conhecimento em ação e não se perder na paralisia pela análise",
                missao: "Descobrir verdades e compartilhar sabedoria para melhorar o mundo",
                cor: "#2196f3",
                link: "https://drive.google.com/file/d/1KFYCzWI1Su3Uu-_n43zh9Zpxz-Pf-l2n/view"
            },
            "Amante": {
                emoji: "❤️",
                frase: "Vivo intensamente cada momento, celebrando paixão e conexões profundas",
                forca: "Paixão intensa, capacidade de criar vínculos profundos, apreciação da beleza",
                desafio: "Manter equilíbrio e identidade própria sem perder a intensidade",
                missao: "Cultivar amor, intimidade e experiências que celebram a vida",
                cor: "#e91e63",
                link: "https://drive.google.com/file/d/1ZVpoxfLe7FmdCbGPbkU5I6Aem0pedD0C/view"
            },
            "Bobo da Corte": {
                emoji: "🤹",
                frase: "Através da alegria e do humor, transformo o comum em extraordinário",
                forca: "Alegria contagiante, espontaneidade, capacidade de viver o momento presente",
                desafio: "Desenvolver seriedade quando necessário sem perder a leveza",
                missao: "Trazer alegria e ajudar outros a aproveitarem a jornada da vida",
                cor: "#ff9800",
                link: "https://drive.google.com/file/d/1rICMnizREBE18SXj8UlptJ5oG9_4EtjX/view"
            },
            "Criador": {
                emoji: "🎨",
                frase: "Dou vida à imaginação, criando algo único e duradouro",
                forca: "Imaginação fértil, habilidades criativas, visão artística única",
                desafio: "Completar projetos e não se perder no perfeccionismo paralisante",
                missao: "Criar algo de valor duradouro e expressar a visão interior",
                cor: "#9c27b0",
                link: "https://drive.google.com/file/d/1cN14uvBAA6bDEwBz13r68EZiP7ZrTxcK/view"
            },
            "Explorador": {
                emoji: "🧭",
                frase: "Busco novos horizontes e experiências que expandem minha alma",
                forca: "Coragem para explorar, autonomia, busca constante por autenticidade",
                desafio: "Encontrar propósito além da busca e criar raízes quando necessário",
                missao: "Descobrir novos territórios e viver uma vida autêntica e significativa",
                cor: "#795548",
                link: "https://drive.google.com/file/d/1lyUCBfEFdpU3d-b4H9OA_TBkw34KqxFI/view"
            },
            "Fora-da-Lei": {
                emoji: "⚡",
                frase: "Desafio o status quo para criar um mundo melhor e mais justo",
                forca: "Coragem de desafiar, pensamento revolucionário, energia para mudanças radicais",
                desafio: "Canalizar a rebeldia de forma construtiva sem se tornar destrutivo",
                missao: "Romper com o que não funciona e libertar os oprimidos",
                cor: "#212121",
                link: "https://drive.google.com/file/d/1S7cSds2EBhYv9Z89keky4OZhoFwgOJ8N/view"
            },
            "Governante": {
                emoji: "👑",
                frase: "Lidero com responsabilidade para criar ordem e prosperidade",
                forca: "Liderança natural, capacidade de organizar, visão estratégica",
                desafio: "Evitar o controle excessivo e aprender a delegar com confiança",
                missao: "Criar um ambiente próspero e estável para todos",
                cor: "#ffd700",
                link: "https://drive.google.com/file/d/1UyqIw8B6Y7c7KC4F39jPyua9YxCsPLS9/view"
            },
            "Herói": {
                emoji: "⚔️",
                frase: "Enfrento desafios com coragem para proteger o que importa",
                forca: "Coragem excepcional, determinação inabalável, capacidade de superar obstáculos",
                desafio: "Reconhecer limitações e aceitar ajuda sem sentir fraqueza",
                missao: "Provar o valor através de atos corajosos e inspirar outros",
                cor: "#f44336",
                link: "https://drive.google.com/file/d/1EQmKb9fpHicpe1NAAlUVBCmyNQ4NxAop/view"
            },
            "Homem Comum": {
                emoji: "🤝",
                frase: "Minha força está na autenticidade e na conexão genuína com todos",
                forca: "Empatia natural, autenticidade, capacidade de criar senso de comunidade",
                desafio: "Desenvolver confiança própria sem perder a humildade",
                missao: "Pertencer e ajudar outros a se sentirem aceitos como são",
                cor: "#607d8b",
                link: "https://drive.google.com/file/d/1kTvylHOYpzbTu41GnvQisHcQbTk4Xv5A/view"
            }
        };

        // ==================== VARIÁVEIS GLOBAIS ====================
        let todosAlunos = [];
        let alunoData = null;
        let biblioteca = [];

        // ==================== UTILITÁRIOS ====================
        function mostrarMensagem(elementId, mensagem, tipo) {
            const el = document.getElementById(elementId);
            el.className = tipo === 'erro' ? 'error-message' : 
                          tipo === 'sucesso' ? 'success-message' : 'info-message';
            el.textContent = mensagem;
            el.style.display = 'block';
        }

        function limparMensagem(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }

        function trocarTela(esconderIds, mostrarId) {
            esconderIds.forEach(id => document.getElementById(id).classList.add('hidden'));
            document.getElementById(mostrarId).classList.remove('hidden');
        }

        function calcularForcaSenha(senha) {
            let forca = 0;
            if (senha.length >= 8) forca++;
            if (senha.length >= 12) forca++;
            if (/[a-z]/.test(senha) && /[A-Z]/.test(senha)) forca++;
            if (/\d/.test(senha)) forca++;
            if (/[^a-zA-Z0-9]/.test(senha)) forca++;
            return Math.min(forca, 3);
        }

        function atualizarBarraForca(senhaInput, barraId) {
            const senha = senhaInput.value;
            const barra = document.getElementById(barraId);
            const forca = calcularForcaSenha(senha);
            
            barra.style.width = (forca * 33.33) + '%';
            barra.className = 'password-strength-bar';
            
            if (forca === 1) barra.classList.add('strength-weak');
            else if (forca === 2) barra.classList.add('strength-medium');
            else if (forca === 3) barra.classList.add('strength-strong');
        }

        // ==================== CARREGAR DADOS ====================
        async function carregarDados() {
            try {
                console.log('🔄 Carregando dados das abas da planilha...');
                
                todosAlunos = [];
                biblioteca = [];
                let linksFormularios = {};
                
                // ===== PASSO 1: Carregar CONFIG (Links dos formulários) =====
                try {
                    const configResponse = await fetch(getURL(ABAS.CONFIG));
                    const configText = await configResponse.text();
                    const configJson = JSON.parse(configText.substring(47, configText.length - 2));
                    
                    configJson.table.rows.forEach((row, index) => {
                        if (index === 0) return;
                        const turma = row.c[0]?.v;
                        if (turma && turma.includes('TURMA')) {
                            linksFormularios[turma] = {
                                anamnese: row.c[1]?.v || '',
                                jornada: row.c[2]?.v || '',
                                escritor: row.c[3]?.v || '',
                                influenciador: row.c[4]?.v || '',
                                palestrante: row.c[5]?.v || '',
                                mentor: row.c[6]?.v || ''
                            };
                        }
                    });
                } catch (erro) {
                    console.warn('⚠️ CONFIG não carregou:', erro.message);
                }
                
                // ===== PASSO 2: Carregar TURMA 1 =====
                try {
                    const t1Response = await fetch(getURL(ABAS.TURMA_1));
                    const t1Text = await t1Response.text();
                    const t1Json = JSON.parse(t1Text.substring(47, t1Text.length - 2));
                    
                    t1Json.table.rows.forEach((row, index) => {
                        if (index === 0) return;
                        const nome = row.c[0]?.v;
                        if (nome && nome.trim() !== '' && !nome.includes('Nome')) {
                            const turma = row.c[2]?.v || 'TURMA 1';
                            const links = linksFormularios[turma] || {};
                            
                            todosAlunos.push({
                                nome: nome,
                                email: row.c[1]?.v || '',
                                turma: turma,
                                nomePreferido: row.c[10]?.v || nome.split(' ')[0],
                                senha: row.c[9]?.v || '',
                                codigoRecuperacao: '',
                                primeiroAcesso: 'Não',
                                arquetipo: row.c[11]?.v || '',
                                formularios: [
                                    { nome: 'Anamnese Geral + Visão de Futuro', status: row.c[3]?.v || 'Pendente', link: links.anamnese || '' },
                                    { nome: 'Jornada do Herói', status: row.c[4]?.v || 'Pendente', link: links.jornada || '' },
                                    { nome: 'Escritor Best Seller', status: row.c[5]?.v || 'Pendente', link: links.escritor || '' },
                                    { nome: 'Influenciador Digital', status: row.c[6]?.v || 'Pendente', link: links.influenciador || '' },
                                    { nome: 'Palestrante Poderoso', status: row.c[7]?.v || 'Pendente', link: links.palestrante || '' },
                                    { nome: 'Mentor High Ticket', status: row.c[8]?.v || 'Pendente', link: links.mentor || '' }
                                ]
                            });
                        }
                    });
                    console.log(`✅ TURMA 1: ${todosAlunos.length} alunos`);
                } catch (erro) {
                    console.error('❌ TURMA 1 falhou:', erro.message);
                }
                
                // ===== PASSO 3: Carregar TURMA 2 =====
                try {
                    const t2Response = await fetch(getURL(ABAS.TURMA_2));
                    const t2Text = await t2Response.text();
                    const t2Json = JSON.parse(t2Text.substring(47, t2Text.length - 2));
                    
                    const countAntes = todosAlunos.length;
                    t2Json.table.rows.forEach((row, index) => {
                        if (index === 0) return;
                        const nome = row.c[0]?.v;
                        if (nome && nome.trim() !== '' && !nome.includes('Nome')) {
                            const turma = row.c[2]?.v || 'TURMA 2';
                            const links = linksFormularios[turma] || {};
                            
                            todosAlunos.push({
                                nome: nome,
                                email: row.c[1]?.v || '',
                                turma: turma,
                                nomePreferido: row.c[10]?.v || nome.split(' ')[0],
                                senha: row.c[9]?.v || '',
                                codigoRecuperacao: '',
                                primeiroAcesso: 'Não',
                                arquetipo: row.c[11]?.v || '',
                                formularios: [
                                    { nome: 'Anamnese Geral + Visão de Futuro', status: row.c[3]?.v || 'Pendente', link: links.anamnese || '' },
                                    { nome: 'Jornada do Herói', status: row.c[4]?.v || 'Pendente', link: links.jornada || '' },
                                    { nome: 'Escritor Best Seller', status: row.c[5]?.v || 'Pendente', link: links.escritor || '' },
                                    { nome: 'Influenciador Digital', status: row.c[6]?.v || 'Pendente', link: links.influenciador || '' },
                                    { nome: 'Palestrante Poderoso', status: row.c[7]?.v || 'Pendente', link: links.palestrante || '' },
                                    { nome: 'Mentor High Ticket', status: row.c[8]?.v || 'Pendente', link: links.mentor || '' }
                                ]
                            });
                        }
                    });
                    console.log(`✅ TURMA 2: ${todosAlunos.length - countAntes} alunos`);
                } catch (erro) {
                    console.error('❌ TURMA 2 falhou:', erro.message);
                }
                
                // ===== PASSO 4: Carregar RECURSOS =====
                try {
                    const recResponse = await fetch(getURL(ABAS.RECURSOS));
                    const recText = await recResponse.text();
                    const recJson = JSON.parse(recText.substring(47, recText.length - 2));
                    
                    recJson.table.rows.forEach((row, index) => {
                        if (index === 0) return;
                        const titulo = row.c[0]?.v;
                        if (titulo && titulo.trim() !== '' && !titulo.includes('Nome do Arquivo')) {
                            biblioteca.push({
                                titulo: titulo,
                                turma: row.c[1]?.v || '',
                                link: row.c[2]?.v || '',
                                descricao: row.c[3]?.v || '',
                                categoria: row.c[4]?.v || '',
                                emoji: row.c[5]?.v || '📄'
                            });
                        }
                    });
                    console.log(`✅ RECURSOS: ${biblioteca.length} itens`);
                } catch (erro) {
                    console.warn('⚠️ RECURSOS não carregou:', erro.message);
                }
                
                console.log(`✅ TOTAL: ${todosAlunos.length} alunos, ${biblioteca.length} recursos`);
                return true;
            } catch (erro) {
                console.error('❌ Erro geral:', erro);
                return false;
            }
        }

        // ==================== FUNÇÃO ARQUÉTIPO (NOVA!) ====================
        function renderizarArquetipo() {
            console.log('🎯 ========== RENDERIZANDO ARQUÉTIPO ==========');
            console.log('📋 Aluno:', alunoData.nome);
            console.log('📋 Turma:', alunoData.turma);
            
            const arquetipoSection = document.getElementById('arquetipoSection');
            if (!arquetipoSection) {
                console.error('❌ Seção de arquétipo NÃO encontrada no HTML (id="arquetipoSection")');
                return;
            }
            console.log('✅ Seção HTML encontrada');

            const arquetipoNome = alunoData.arquetipo;
            console.log('📋 Arquétipo da planilha (coluna L):', `"${arquetipoNome}"`);

            // Se não tem arquétipo ou é "Pendente", esconde a seção
            if (!arquetipoNome || arquetipoNome === 'Pendente' || arquetipoNome.trim() === '') {
                console.log('⚠️ Aluno não tem arquétipo definido na coluna L');
                console.log('💡 Para exibir arquétipo, preencha a coluna L da planilha com um destes:');
                console.log('   ', Object.keys(ARQUETIPOS_DATA).join(', '));
                arquetipoSection.style.display = 'none';
                return;
            }

            // Busca dados do arquétipo (CASE-INSENSITIVE!)
            // Normaliza o nome para buscar: "HERÓI" ou "herói" → "Herói"
            let arquetipo = ARQUETIPOS_DATA[arquetipoNome]; // Tenta busca direta primeiro
            
            if (!arquetipo) {
                // Se não encontrou, busca ignorando maiúsculas/minúsculas
                const arquetipoNomeLower = arquetipoNome.toLowerCase();
                const chaveEncontrada = Object.keys(ARQUETIPOS_DATA).find(
                    chave => chave.toLowerCase() === arquetipoNomeLower
                );
                
                if (chaveEncontrada) {
                    arquetipo = ARQUETIPOS_DATA[chaveEncontrada];
                    console.log(`✅ Arquétipo encontrado (normalizado): "${arquetipoNome}" → "${chaveEncontrada}"`);
                }
            }
            
            if (!arquetipo) {
                console.error('❌ Arquétipo NÃO encontrado:', `"${arquetipoNome}"`);
                console.log('💡 Arquétipos disponíveis:', Object.keys(ARQUETIPOS_DATA));
                console.log('⚠️ Verifique se o nome na coluna L tem acentos corretos');
                arquetipoSection.style.display = 'none';
                return;
            }

            console.log('✅ Dados do arquétipo encontrados!');
            console.log('   Emoji:', arquetipo.emoji);
            console.log('   Cor:', arquetipo.cor);

            // Aplica a cor personalizada
            const card = arquetipoSection.querySelector('.arquetipo-card');
            const nome = arquetipoSection.querySelector('.arquetipo-nome');
            if (card) card.style.borderColor = arquetipo.cor;
            if (nome) nome.style.textShadow = `0 0 20px ${arquetipo.cor}`;

            // Preenche os dados
            arquetipoSection.querySelector('.arquetipo-emoji').textContent = arquetipo.emoji;
            arquetipoSection.querySelector('.arquetipo-nome').textContent = arquetipoNome;
            arquetipoSection.querySelector('.arquetipo-frase').textContent = arquetipo.frase;
            
            arquetipoSection.querySelector('.arquetipo-detalhes').innerHTML = `
                <div class="arquetipo-item">
                    <span class="arquetipo-label">💪 Sua Força</span>
                    <p class="arquetipo-texto">${arquetipo.forca}</p>
                </div>
                <div class="arquetipo-item">
                    <span class="arquetipo-label">🎯 Seu Desafio</span>
                    <p class="arquetipo-texto">${arquetipo.desafio}</p>
                </div>
                <div class="arquetipo-item">
                    <span class="arquetipo-label">🌟 Sua Missão</span>
                    <p class="arquetipo-texto">${arquetipo.missao}</p>
                </div>
            `;

            const btnDownload = arquetipoSection.querySelector('.btn-download-arquetipo');
            btnDownload.href = arquetipo.link;
            btnDownload.target = '_blank';

            // Mostra a seção
            arquetipoSection.style.display = 'block';
            console.log('✅ ========== ARQUÉTIPO EXIBIDO COM SUCESSO! ==========');
        }

        // ==================== LOGIN ====================
        async function verificarAluno(email, senha) {
            const carregou = await carregarDados();
            if (!carregou) return null;
            
            if (email === 'mentordelideres@gmail.com' && senha === 'master2024') {
                return { tipo: 'master' };
            }
            
            const aluno = todosAlunos.find(a => a.email.toLowerCase() === email.toLowerCase());
            
            if (!aluno) return null;
            if (aluno.senha !== senha) return null;
            
            const emailAluno = aluno.email;
            const turma = aluno.turma;
            
            return {
                tipo: 'aluno',
                nome: aluno.nome,
                nomePreferido: aluno.nomePreferido,
                email: emailAluno,
                turma: turma,
                arquetipo: aluno.arquetipo || '',
                formularios: aluno.formularios,  // Usa os formulários que já vêm da planilha com nomes corretos
                primeiroAcesso: aluno.primeiroAcesso === 'Sim'
            };
        }

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            limparMensagem('loginMessage');
            
            const email = document.getElementById('emailInput').value;
            const senha = document.getElementById('senhaInput').value;
            const btnLogin = document.getElementById('btnLogin');
            
            btnLogin.disabled = true;
            btnLogin.textContent = 'Entrando...';
            
            const usuario = await verificarAluno(email, senha);
            
            if (!usuario) {
                mostrarMensagem('loginMessage', 'Email ou senha incorretos', 'erro');
                btnLogin.disabled = false;
                btnLogin.textContent = 'Entrar';
                return;
            }
            
            if (usuario.tipo === 'master') {
                trocarTela(['loginScreen'], 'masterDashboard');
                await renderizarMasterDashboard();
            } else {
                alunoData = usuario;
                
                if (usuario.primeiroAcesso) {
                    trocarTela(['loginScreen'], 'primeiroAcessoScreen');
                } else {
                    trocarTela(['loginScreen'], 'dashboardScreen');
                    mostrarDashboard();
                }
            }
            
            btnLogin.disabled = false;
            btnLogin.textContent = 'Entrar';
        });

        // ==================== DASHBOARD ALUNO ====================
        function mostrarDashboard() {
            const progress = calcularProgresso();
            const nomeExibicao = alunoData.nomePreferido || alunoData.nome.split(' ')[0];
            
            const linksPlataforma = {
                'TURMA 1': 'https://aluno.omentordelideres.com.br/login',
                'TURMA 2': 'https://aluno.omentordelideres.com.br/login'
            };
            
            const calendarios = {
                'TURMA 1': [
                    { nome: 'Influenciador Digital - Leonardo', link: 'https://calendly.com/leonardomuniz-febracis/suporte-influenciador-digital?month=2025-11' },
                    { nome: 'Escritor Best Seller - Luana', link: 'https://calendly.com/luanarocha-febracis/suporte_escritor?month=2025-11' },
                    { nome: 'Palestra/Mentoria - Michelle', link: 'https://calendly.com/michellecastro-febracis/30min?month=2025-12' }
                ],
                'TURMA 2': [
                    { nome: 'Influenciador Digital - Leonardo', link: 'https://calendar.app.google/aY65WhmjohSAqn3R6' },
                    { nome: 'Escritor Best Seller - Luana', link: 'https://calendar.app.google/bdA65V5Fy4JKmiAK6' },
                    { nome: 'Palestra/Mentoria - Michelle', link: 'https://calendar.app.google/1egzPjhvsj2VRc5W9' }
                ]
            };
            
            const linkPlataforma = linksPlataforma[alunoData.turma] || '#';
            const mentoresTurma = calendarios[alunoData.turma] || [];
            
            document.getElementById('dashboardContent').innerHTML = `
                <div class="dashboard-header">
                    <div>
                        <h2>Olá, ${nomeExibicao}! 👋</h2>
                        <p>${alunoData.turma}</p>
                    </div>
                    <div class="aluno-header-actions">
                        <button class="btn-edit-name" id="btnEditarNome">
                            ✏️ Editar Nome
                        </button>
                        <button class="logout-btn-aluno" id="btnLogoutAluno">Sair</button>
                    </div>
                </div>

                <div class="progress-section">
                    <div class="progress-header">
                        <h3>📊 Seu Progresso</h3>
                        <span class="progress-percentage">${progress}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>

                <!-- SEÇÃO DE ARQUÉTIPO -->
                <div id="arquetipoSection" class="arquetipo-section" style="display: none;">
                    <div class="arquetipo-header">
                        <span class="arquetipo-icon-header">🌟</span>
                        <h3 class="arquetipo-title-main">SEU ARQUÉTIPO</h3>
                    </div>
                    <div class="arquetipo-card">
                        <div class="arquetipo-card-content">
                            <div class="arquetipo-emoji">🦁</div>
                            <h4 class="arquetipo-nome">HERÓI</h4>
                            <p class="arquetipo-frase">"Frase inspiradora aqui"</p>
                            <div class="arquetipo-detalhes"></div>
                            <a href="#" class="btn-download-arquetipo" target="_blank">
                                <span class="btn-icon">📥</span>
                                <span>Baixar PDF do Arquétipo</span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="acesso-rapido-section">
                    <div class="acesso-rapido-header">
                        <span class="acesso-rapido-icon">🚀</span>
                        <h3 class="acesso-rapido-title">Acesso Rápido</h3>
                    </div>
                    
                    <a href="${linkPlataforma}" target="_blank" class="btn-plataforma-videos">
                        <span class="btn-icon">🎬</span>
                        <div class="btn-text">
                            <strong>Plataforma de Vídeos</strong>
                            <small>Acesse os conteúdos exclusivos da sua turma</small>
                        </div>
                        <span class="btn-arrow">→</span>
                    </a>

                    <div class="agendamento-section">
                        <div class="agendamento-header">
                            <span class="agendamento-icon">📅</span>
                            <h4>Agende com o Mentor</h4>
                        </div>
                        <div class="mentores-grid">
                            ${mentoresTurma.map(mentor => `
                                <a href="${mentor.link}" target="_blank" class="btn-mentor">
                                    <span class="mentor-icon">👤</span>
                                    <span class="mentor-nome">${mentor.nome}</span>
                                    <span class="mentor-arrow">→</span>
                                </a>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <div id="bibliotecaContainer"></div>
                <h2 class="section-title">📝 Seus Formulários</h2>
                <div id="formulariosContainer"></div>
            `;

            document.getElementById('btnEditarNome').addEventListener('click', abrirModalEditarNome);
            document.getElementById('btnLogoutAluno').addEventListener('click', () => {
                trocarTela(['dashboardScreen'], 'loginScreen');
                document.getElementById('loginForm').reset();
            });

            renderizarBiblioteca();
            configurarAcessoRapido();
            renderizarArquetipo();  // ← CORREÇÃO 2 APLICADA!
            renderizarFormularios();
        }

        function calcularProgresso() {
            const preenchidos = alunoData.formularios.filter(f => f.status === 'Preenchido').length;
            return Math.round((preenchidos / 6) * 100);
        }

        function renderizarBiblioteca() {
            const container = document.getElementById('bibliotecaContainer');
            
            // Filtrar recursos por turma do aluno
            const recursosFiltrados = biblioteca.filter(recurso => {
                if (!recurso.turma || recurso.turma.trim() === '') {
                    return true; // Recursos sem turma aparecem para todos
                }
                return recurso.turma === alunoData.turma; // Só mostra da mesma turma
            });
            
            console.log(`📚 Biblioteca: ${biblioteca.length} total, ${recursosFiltrados.length} para ${alunoData.turma}`);
            
            // DEBUG: Ver o que tem nos recursos
            if (recursosFiltrados.length > 0) {
                console.log('📋 Primeiro recurso:', {
                    titulo: recursosFiltrados[0].titulo,
                    descricao: recursosFiltrados[0].descricao,
                    categoria: recursosFiltrados[0].categoria
                });
            }
            
            if (recursosFiltrados.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = `
                <div class="biblioteca-section">
                    <div class="biblioteca-header">
                        <span class="biblioteca-icon">📚</span>
                        <h3 class="biblioteca-title">Biblioteca de Recursos</h3>
                    </div>
                    <div class="recursos-grid">
                        ${recursosFiltrados.map(recurso => `
                            <div class="recurso-card">
                                <span class="recurso-icon" style="font-size: 2em;">${recurso.emoji}</span>
                                <h4 style="color: white; font-size: 1.1em; margin: 10px 0;">${recurso.titulo}</h4>
                                <a href="${recurso.link}" target="_blank" class="btn-download" style="margin-top: 10px;">
                                    📥 Acessar Recurso
                                </a>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function configurarAcessoRapido() {
            // Configuração já está no HTML gerado
        }

        function renderizarFormularios() {
            const container = document.getElementById('formulariosContainer');
            container.innerHTML = `
                <div class="formularios-grid">
                    ${alunoData.formularios.map(form => `
                        <div class="formulario-card">
                            <div class="formulario-header">
                                <h4 class="formulario-title">${form.nome}</h4>
                                <span class="status-badge ${form.status === 'Preenchido' ? 'status-preenchido' : 'status-pendente'}">
                                    ${form.status === 'Preenchido' ? '✓ Preenchido' : '⏳ Pendente'}
                                </span>
                            </div>
                            ${form.status === 'Preenchido' 
                                ? `<a href="${form.link}" target="_blank" class="btn-formulario btn-concluido">✓ Visualizar</a>`
                                : `<a href="${form.link}" target="_blank" class="btn-formulario btn-preencher">Preencher Agora</a>`
                            }
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // ==================== MODAL EDITAR NOME ====================
        function abrirModalEditarNome() {
            const modal = document.getElementById('modalEditarNome');
            const input = document.getElementById('novoNomePreferido');
            input.value = alunoData.nomePreferido || '';
            modal.classList.add('active');
        }

        function fecharModalEditarNome() {
            const modal = document.getElementById('modalEditarNome');
            modal.classList.remove('active');
        }

        document.getElementById('btnCancelarNome').addEventListener('click', fecharModalEditarNome);
        
        document.getElementById('btnSalvarNome').addEventListener('click', async () => {
            const novoNome = document.getElementById('novoNomePreferido').value.trim();
            if (!novoNome) {
                alert('Por favor, digite um nome.');
                return;
            }
            
            alunoData.nomePreferido = novoNome;
            alert('✅ Nome atualizado com sucesso!\n\n⚠️ Observação: Esta alteração é temporária nesta sessão. Para salvar permanentemente, você precisa atualizar a planilha do Google Sheets.');
            
            fecharModalEditarNome();
            mostrarDashboard();
        });

        document.getElementById('modalEditarNome').addEventListener('click', (e) => {
            if (e.target.id === 'modalEditarNome') {
                fecharModalEditarNome();
            }
        });

        // ==================== PRIMEIRO ACESSO ====================
        document.getElementById('novaSenhaPrimeiroAcesso').addEventListener('input', function() {
            atualizarBarraForca(this, 'strengthBarPrimeiroAcesso');
        });

        document.getElementById('primeiroAcessoForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            limparMensagem('primeiroAcessoMessage');
            
            const nomePreferido = document.getElementById('nomePreferidoInput').value.trim();
            const novaSenha = document.getElementById('novaSenhaPrimeiroAcesso').value;
            const confirmarSenha = document.getElementById('confirmarSenhaPrimeiroAcesso').value();
            
            if (novaSenha !== confirmarSenha) {
                mostrarMensagem('primeiroAcessoMessage', 'As senhas não coincidem', 'erro');
                return;
            }
            
            if (calcularForcaSenha(novaSenha) < 2) {
                mostrarMensagem('primeiroAcessoMessage', 'Senha muito fraca. Use pelo menos 8 caracteres com letras e números.', 'erro');
                return;
            }
            
            alunoData.nomePreferido = nomePreferido;
            alunoData.senha = novaSenha;
            alunoData.primeiroAcesso = false;
            
            mostrarMensagem('primeiroAcessoMessage', '✅ Configuração concluída!\n\n⚠️ Para salvar permanentemente, atualize a planilha:\n- Nome Preferido na coluna C\n- Nova Senha na coluna E\n- "Primeiro Acesso" = "Não" na coluna H', 'sucesso');
            
            setTimeout(() => {
                trocarTela(['primeiroAcessoScreen'], 'dashboardScreen');
                mostrarDashboard();
            }, 3000);
        });

        // ==================== RECUPERAÇÃO DE SENHA ====================
        document.getElementById('linkEsqueciSenha').addEventListener('click', () => {
            trocarTela(['loginScreen'], 'recuperarSenhaScreen');
            limparMensagem('recuperarMessage');
        });

        document.getElementById('linkVoltarLogin').addEventListener('click', () => {
            trocarTela(['recuperarSenhaScreen'], 'loginScreen');
        });

        document.getElementById('linkVoltarLogin2').addEventListener('click', () => {
            trocarTela(['redefinirSenhaScreen'], 'loginScreen');
        });

        document.getElementById('recuperarForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            limparMensagem('recuperarMessage');
            
            const email = document.getElementById('emailRecuperar').value;
            await carregarDados();
            
            const aluno = todosAlunos.find(a => a.email.toLowerCase() === email.toLowerCase());
            
            if (!aluno || !aluno.codigoRecuperacao) {
                mostrarMensagem('recuperarMessage', 'Email não encontrado ou sem código de recuperação configurado', 'erro');
                return;
            }
            
            mostrarMensagem('recuperarMessage', `✅ Código encontrado: ${aluno.codigoRecuperacao}`, 'sucesso');
            
            setTimeout(() => {
                trocarTela(['recuperarSenhaScreen'], 'redefinirSenhaScreen');
            }, 2000);
        });

        document.getElementById('novaSenha').addEventListener('input', function() {
            atualizarBarraForca(this, 'strengthBar');
        });

        document.getElementById('redefinirForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            limparMensagem('redefinirMessage');
            
            const codigo = document.getElementById('codigoRecuperacao').value;
            const novaSenha = document.getElementById('novaSenha').value;
            const confirmarSenha = document.getElementById('confirmarSenha').value;
            
            if (novaSenha !== confirmarSenha) {
                mostrarMensagem('redefinirMessage', 'As senhas não coincidem', 'erro');
                return;
            }
            
            if (calcularForcaSenha(novaSenha) < 2) {
                mostrarMensagem('redefinirMessage', 'Senha muito fraca. Use pelo menos 8 caracteres com letras e números.', 'erro');
                return;
            }
            
            await carregarDados();
            const aluno = todosAlunos.find(a => a.codigoRecuperacao === codigo);
            
            if (!aluno) {
                mostrarMensagem('redefinirMessage', 'Código de recuperação inválido', 'erro');
                return;
            }
            
            mostrarMensagem('redefinirMessage', `✅ Senha redefinida com sucesso!\n\n⚠️ Atualize a coluna E (Senha) na planilha para: ${novaSenha}`, 'sucesso');
            
            setTimeout(() => {
                trocarTela(['redefinirSenhaScreen'], 'loginScreen');
                document.getElementById('redefinirForm').reset();
            }, 3000);
        });

        // ==================== MASTER DASHBOARD ====================
        async function renderizarMasterDashboard() {
            await carregarDados();
            
            const stats = calcularEstatisticas();
            
            document.getElementById('masterContent').innerHTML = `
                <div class="dashboard-header">
                    <div>
                        <h2>Dashboard Master 🦁</h2>
                        <p>Visão completa do programa</p>
                    </div>
                    <div class="master-header-actions">
                        <span class="badge-master">ADMIN</span>
                        <button class="logout-btn-header" id="btnLogoutMaster">Sair</button>
                    </div>
                </div>

                <div class="strategic-section">
                    <h2 class="strategic-title">📊 Visão Estratégica</h2>
                    
                    <div class="kpi-grid-strategic">
                        <div class="kpi-card">
                            <div class="kpi-label">Taxa de Conclusão</div>
                            <div class="kpi-value">${stats.progressoMedio}%</div>
                            <div class="kpi-sublabel">Meta: 100%</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Alunos Ativos</div>
                            <div class="kpi-value">${stats.totalAlunos}</div>
                            <div class="kpi-sublabel">${stats.turma1} T1 + ${stats.turma2} T2</div>
                        </div>
                        <div class="kpi-card ${stats.alunosEmRisco > 0 ? 'kpi-alert' : ''}">
                            <div class="kpi-label">Alunos em Risco</div>
                            <div class="kpi-value">${stats.alunosEmRisco}</div>
                            <div class="kpi-sublabel">&lt; 33% progresso</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Turma Líder</div>
                            <div class="kpi-value">${stats.turmaLider}</div>
                            <div class="kpi-sublabel">${stats.turmaLiderPercent}%</div>
                        </div>
                    </div>

                    ${renderizarComparacaoTurmas(stats)}
                    ${renderizarInsights(stats)}
                    
                    <!-- Análise de Formulário INTEGRADA -->
                    <h3 class="section-subtitle">📋 Análise por Formulário</h3>
                    ${renderizarAnaliseFormularios()}
                </div>

                <!-- Distribuição de Arquétipos -->
                <div class="arquetipos-stats-section">
                    <h2 class="section-title">🌟 Distribuição de Arquétipos</h2>
                    ${renderizarDistribuicaoArquetipos()}
                </div>

                <div class="tabs">
                    <div class="tab active" data-tab="turma1">TURMA 1 (${stats.turma1})</div>
                    <div class="tab" data-tab="turma2">TURMA 2 (${stats.turma2})</div>
                    <div class="tab" data-tab="todos">TODOS (${stats.totalAlunos})</div>
                </div>

                <div id="alunosContainer"></div>
            `;

            document.getElementById('btnLogoutMaster').addEventListener('click', () => {
                trocarTela(['masterDashboard'], 'loginScreen');
                document.getElementById('loginForm').reset();
            });

            configurarTabs();
            renderizarAlunos('turma1');
            atualizarAnaliseFormulario(); // Inicializar análise do primeiro formulário
        }

        function calcularEstatisticas() {
            const stats = {
                totalAlunos: todosAlunos.length,
                turma1: todosAlunos.filter(a => a.turma === 'TURMA 1').length,
                turma2: todosAlunos.filter(a => a.turma === 'TURMA 2').length,
                formulariosPreenchidos: 0,
                formulariosPendentes: 0,
                totalFormularios: todosAlunos.length * 6,
                progressoMedio: 0
            };

            let somaProgresso = 0;

            todosAlunos.forEach(aluno => {
                aluno.formularios.forEach(form => {
                    if (form.status === 'Preenchido') {
                        stats.formulariosPreenchidos++;
                    } else {
                        stats.formulariosPendentes++;
                    }
                });
                somaProgresso += (aluno.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100;
            });

            stats.progressoMedio = Math.round(somaProgresso / todosAlunos.length);

            // Novos KPIs Estratégicos
            // 1. Alunos em Risco (< 33% de progresso)
            stats.alunosEmRisco = todosAlunos.filter(aluno => {
                const progresso = (aluno.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100;
                return progresso < 33;
            }).length;

            // 2. Turma Líder
            const turma1Alunos = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2Alunos = todosAlunos.filter(a => a.turma === 'TURMA 2');
            
            const t1Percent = Math.round(
                (turma1Alunos.reduce((acc, a) => 
                    acc + a.formularios.filter(f => f.status === 'Preenchido').length, 0
                ) / (turma1Alunos.length * 6)) * 100
            );
            
            const t2Percent = Math.round(
                (turma2Alunos.reduce((acc, a) => 
                    acc + a.formularios.filter(f => f.status === 'Preenchido').length, 0
                ) / (turma2Alunos.length * 6)) * 100
            );

            if (t1Percent > t2Percent) {
                stats.turmaLider = 'TURMA 1';
                stats.turmaLiderPercent = t1Percent;
            } else if (t2Percent > t1Percent) {
                stats.turmaLider = 'TURMA 2';
                stats.turmaLiderPercent = t2Percent;
            } else {
                stats.turmaLider = 'EMPATE';
                stats.turmaLiderPercent = t1Percent;
            }

            return stats;
        }

        function renderizarComparacaoTurmas(stats) {
            const turma1Alunos = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2Alunos = todosAlunos.filter(a => a.turma === 'TURMA 2');

            const calcularStats = (alunos) => {
                const preenchidos = alunos.reduce((acc, a) => 
                    acc + a.formularios.filter(f => f.status === 'Preenchido').length, 0);
                const total = alunos.length * 6;
                return {
                    preenchidos,
                    total,
                    percentual: Math.round((preenchidos / total) * 100)
                };
            };

            const t1 = calcularStats(turma1Alunos);
            const t2 = calcularStats(turma2Alunos);

            return `
                <div class="comparison-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Métrica</th>
                                <th>TURMA 1</th>
                                <th>TURMA 2</th>
                                <th>Diferença</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Total de Alunos</strong></td>
                                <td>${stats.turma1}</td>
                                <td>${stats.turma2}</td>
                                <td class="gap-indicator ${stats.turma1 > stats.turma2 ? 'gap-positive' : stats.turma1 < stats.turma2 ? 'gap-negative' : ''}">
                                    ${stats.turma1 - stats.turma2 > 0 ? '+' : ''}${stats.turma1 - stats.turma2}
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Taxa de Conclusão</strong></td>
                                <td>
                                    ${t1.percentual}%
                                    <div class="progress-bar-mini">
                                        <div class="progress-fill-mini" style="width: ${t1.percentual}%"></div>
                                    </div>
                                </td>
                                <td>
                                    ${t2.percentual}%
                                    <div class="progress-bar-mini">
                                        <div class="progress-fill-mini" style="width: ${t2.percentual}%"></div>
                                    </div>
                                </td>
                                <td>
                                    ${t1.percentual > t2.percentual 
                                        ? '<span class="success-badge">T1 Lidera</span>' 
                                        : t2.percentual > t1.percentual 
                                        ? '<span class="success-badge">T2 Lidera</span>' 
                                        : '<span class="success-badge">Empate</span>'}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderizarInsights(stats) {
            const insights = [];

            if (stats.formulariosPendentes > stats.formulariosPreenchidos) {
                insights.push({
                    titulo: '⚠️ Atenção: Alta Pendência',
                    texto: `${stats.formulariosPendentes} formulários ainda estão pendentes. Considere enviar lembretes aos alunos.`
                });
            }

            if (stats.progressoMedio < 50) {
                insights.push({
                    titulo: '📉 Progresso Abaixo da Meta',
                    texto: `Progresso médio está em ${stats.progressoMedio}%. Recomenda-se ações de engajamento.`
                });
            } else if (stats.progressoMedio >= 80) {
                insights.push({
                    titulo: '🎯 Excelente Desempenho',
                    texto: `Progresso médio de ${stats.progressoMedio}%! A turma está altamente engajada.`
                });
            }

            if (insights.length === 0) {
                insights.push({
                    titulo: '✅ Programa em Andamento',
                    texto: `${stats.formulariosPreenchidos} de ${stats.totalFormularios} formulários concluídos. Continue monitorando o progresso.`
                });
            }

            return insights.map(insight => `
                <div class="insight-box">
                    <h4>${insight.titulo}</h4>
                    <p>${insight.texto}</p>
                </div>
            `).join('');
        }

        function configurarTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const filtro = tab.dataset.tab;
                    
                    if (filtro === 'todos') {
                        renderizarVisaoGeral();
                    } else {
                        renderizarAlunos(filtro);
                    }
                });
            });
        }

        function renderizarAlunos(filtro) {
            let alunosFiltrados = todosAlunos;

            if (filtro === 'turma1') {
                alunosFiltrados = todosAlunos.filter(a => a.turma === 'TURMA 1');
            } else if (filtro === 'turma2') {
                alunosFiltrados = todosAlunos.filter(a => a.turma === 'TURMA 2');
            }

            console.log(`📊 Filtro: ${filtro} | Total: ${todosAlunos.length} | Filtrados: ${alunosFiltrados.length}`);

            const container = document.getElementById('alunosContainer');
            container.innerHTML = alunosFiltrados.map(aluno => {
                const progress = Math.round((aluno.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return `
                    <div class="aluno-card">
                        <div class="aluno-header" onclick="toggleAluno(this)">
                            <div class="aluno-info">
                                <div class="aluno-nome">${aluno.nomePreferido || aluno.nome}</div>
                                <div class="aluno-email">${aluno.email} • ${aluno.turma}</div>
                            </div>
                            <div class="aluno-stats">
                                <div class="mini-progress">${progress}%</div>
                                <div class="expand-icon">▼</div>
                            </div>
                        </div>
                        <div class="aluno-details">
                            <div class="formularios-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Formulário</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${aluno.formularios.map(form => `
                                            <tr>
                                                <td>${form.nome}</td>
                                                <td>
                                                    <span class="status-icon">${form.status === 'Preenchido' ? '✅' : '⏳'}</span>
                                                    ${form.status}
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ==================== VISÃO GERAL COMPLETA ====================
        
        function renderizarVisaoGeral() {
            const container = document.getElementById('alunosContainer');
            
            // Calcular métricas estratégicas
            const totalAlunos = todosAlunos.length;
            
            // Alunos com 100%
            const alunosCem = todosAlunos.filter(a => {
                const prog = Math.round((a.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return prog === 100;
            }).length;
            
            // Alunos em risco (0%)
            const alunosRisco = todosAlunos.filter(a => {
                const prog = Math.round((a.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return prog === 0;
            }).length;
            
            // Médias
            const turma1Alunos = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2Alunos = todosAlunos.filter(a => a.turma === 'TURMA 2');
            const turma1Media = calcularMedia(turma1Alunos);
            const turma2Media = calcularMedia(turma2Alunos);
            const gap = turma1Media - turma2Media;
            
            // Análise por formulário
            const analiseFormularios = analisarFormulariosPorTurma();
            
            // Top 5 e Bottom 5
            const topAlunos = todosAlunos.filter(a => {
                const prog = Math.round((a.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return prog === 100;
            }).slice(0, 5);
            const alunosEmRisco = todosAlunos.filter(a => {
                const prog = Math.round((a.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return prog === 0;
            });
            
            container.innerHTML = `
                <!-- KPIs Executivos -->
                <div class="strategic-section">
                    <h3 class="strategic-title">📊 Indicadores Executivos</h3>
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-label">Taxa de Conclusão Total</div>
                            <div class="kpi-value">${alunosCem}</div>
                            <div class="kpi-sublabel">${Math.round((alunosCem/totalAlunos)*100)}% dos ${totalAlunos} alunos</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Alunos em Risco</div>
                            <div class="kpi-value" style="color: ${alunosRisco > 0 ? '#ff3b30' : '#34c759'};">${alunosRisco}</div>
                            <div class="kpi-sublabel">0% de progresso</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Gap Entre Turmas</div>
                            <div class="kpi-value" style="color: ${Math.abs(gap) > 30 ? '#ff3b30' : Math.abs(gap) > 15 ? '#ffc107' : '#34c759'};">${Math.abs(gap)}%</div>
                            <div class="kpi-sublabel">Turma 1 vs Turma 2</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Média Geral</div>
                            <div class="kpi-value">${calcularMedia(todosAlunos)}%</div>
                            <div class="kpi-sublabel">Todas as turmas</div>
                        </div>
                    </div>
                </div>

                <!-- Comparativo Detalhado -->
                <div class="strategic-section">
                    <h3 class="strategic-title">📈 Comparativo por Formulário</h3>
                    <p style="color: #b8b8b8; margin-bottom: 15px; font-size: 0.9em;">💡 Clique em um formulário para ver a lista detalhada de alunos</p>
                    <div class="comparison-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Formulário</th>
                                    <th>Turma 1 (${turma1Alunos.length} alunos)</th>
                                    <th>Turma 2 (${turma2Alunos.length} alunos)</th>
                                    <th>Gap</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${analiseFormularios.map((form, idx) => `
                                    <tr class="formulario-row" id="form-row-${idx}" onclick="toggleFormularioDetalhes(${idx})">
                                        <td>
                                            <strong>${formularioNomes[idx]}</strong>
                                            <span class="expand-icon-table">▼</span>
                                            <div class="progress-bar-mini">
                                                <div class="progress-fill-mini" style="width: ${form.mediaGeral}%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <strong>${form.turma1Preenchidos}</strong> (${form.turma1Percent}%)
                                        </td>
                                        <td>
                                            <strong>${form.turma2Preenchidos}</strong> (${form.turma2Percent}%)
                                        </td>
                                        <td>
                                            <span class="gap-indicator ${form.gap > 0 ? 'gap-positive' : 'gap-negative'}">
                                                ${form.gap > 0 ? '+' : ''}${form.gap}%
                                            </span>
                                        </td>
                                    </tr>
                                    <tr class="formulario-details" id="form-details-${idx}">
                                        <td colspan="4">
                                            <div class="formulario-details-content">
                                                ${renderizarAlunosPorFormulario(idx)}
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Insights Estratégicos -->
                <div class="strategic-section">
                    <h3 class="strategic-title">💡 Insights e Recomendações</h3>
                    ${gerarInsights(analiseFormularios, gap, alunosRisco, alunosCem, todosAlunos)}
                </div>

                <!-- Listas de Destaques e Atenção -->
                <div class="strategic-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <!-- Top Performers -->
                        ${topAlunos.length > 0 ? `
                            <div class="formulario-card">
                                <h3 style="margin-bottom: 15px;">🏆 Alunos com 100%</h3>
                                ${topAlunos.slice(0, 5).map(aluno => `
                                    <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <div style="font-weight: 600;">${aluno.nomePreferido || aluno.nome}</div>
                                        <div style="font-size: 0.85em; color: #b8b8b8;">${aluno.turma}</div>
                                    </div>
                                `).join('')}
                                ${alunosCem > 5 ? `<p style="margin-top: 10px; color: #b8b8b8; font-size: 0.9em;">+ ${alunosCem - 5} alunos com 100%</p>` : ''}
                            </div>
                        ` : ''}
                        
                        <!-- Alunos em Risco -->
                        ${alunosEmRisco.length > 0 ? `
                            <div class="formulario-card">
                                <h3 style="margin-bottom: 15px;">⚠️ Alunos em Risco (0%)</h3>
                                ${alunosEmRisco.slice(0, 5).map(aluno => `
                                    <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <div style="font-weight: 600;">${aluno.nomePreferido || aluno.nome}</div>
                                        <div style="font-size: 0.85em; color: #b8b8b8;">${aluno.turma}</div>
                                    </div>
                                `).join('')}
                                ${alunosRisco > 5 ? `<p style="margin-top: 10px; color: #b8b8b8; font-size: 0.9em;">+ ${alunosRisco - 5} alunos precisam de atenção</p>` : ''}
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function analisarFormulariosPorTurma() {
            const analise = [];
            const turma1Alunos = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2Alunos = todosAlunos.filter(a => a.turma === 'TURMA 2');
            
            formularioNomes.forEach((nome, idx) => {
                // Turma 1
                const turma1Preenchidos = turma1Alunos.filter(a => 
                    a.formularios[idx].status === 'Preenchido'
                ).length;
                const turma1Percent = turma1Alunos.length > 0 ? Math.round((turma1Preenchidos / turma1Alunos.length) * 100) : 0;
                
                // Turma 2
                const turma2Preenchidos = turma2Alunos.filter(a => 
                    a.formularios[idx].status === 'Preenchido'
                ).length;
                const turma2Percent = turma2Alunos.length > 0 ? Math.round((turma2Preenchidos / turma2Alunos.length) * 100) : 0;
                
                // Gap e média
                const gap = turma1Percent - turma2Percent;
                const mediaGeral = Math.round(((turma1Preenchidos + turma2Preenchidos) / 
                    (turma1Alunos.length + turma2Alunos.length)) * 100);
                
                analise.push({
                    turma1Preenchidos,
                    turma1Percent,
                    turma2Preenchidos,
                    turma2Percent,
                    gap,
                    mediaGeral
                });
            });
            
            return analise;
        }

        function toggleFormularioDetalhes(idx) {
            const row = document.getElementById(`form-row-${idx}`);
            const details = document.getElementById(`form-details-${idx}`);
            
            // Toggle classes
            row.classList.toggle('expanded');
            details.classList.toggle('active');
        }

        function renderizarAlunosPorFormulario(formIdx) {
            const turma1Alunos = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2Alunos = todosAlunos.filter(a => a.turma === 'TURMA 2');
            
            // Separar alunos por turma e status
            const turma1Preenchidos = turma1Alunos.filter(a => 
                a.formularios[formIdx].status === 'Preenchido'
            );
            const turma1Pendentes = turma1Alunos.filter(a => 
                a.formularios[formIdx].status !== 'Preenchido'
            );
            
            const turma2Preenchidos = turma2Alunos.filter(a => 
                a.formularios[formIdx].status === 'Preenchido'
            );
            const turma2Pendentes = turma2Alunos.filter(a => 
                a.formularios[formIdx].status !== 'Preenchido'
            );
            
            return `
                <div class="turmas-comparison">
                    <!-- Turma 1 -->
                    <div class="turma-alunos-box">
                        <div class="turma-alunos-title">📊 Turma 1 (${turma1Alunos.length} alunos)</div>
                        
                        <div class="turma-alunos-content">
                            <!-- Preenchidos -->
                            <div class="alunos-section">
                                <div class="alunos-section-title preenchidos">
                                    ✅ Preenchidos (${turma1Preenchidos.length})
                                </div>
                                ${turma1Preenchidos.length > 0 ? 
                                    turma1Preenchidos.map(aluno => `
                                        <div class="aluno-item">
                                            <div>${aluno.nomePreferido || aluno.nome}</div>
                                        </div>
                                    `).join('') 
                                    : '<div class="empty-list">Nenhum aluno preencheu</div>'
                                }
                            </div>
                            
                            <!-- Pendentes -->
                            <div class="alunos-section">
                                <div class="alunos-section-title pendentes">
                                    ⏳ Pendentes (${turma1Pendentes.length})
                                </div>
                                ${turma1Pendentes.length > 0 ? 
                                    turma1Pendentes.map(aluno => `
                                        <div class="aluno-item">
                                            <div>${aluno.nomePreferido || aluno.nome}</div>
                                        </div>
                                    `).join('')
                                    : '<div class="empty-list">Todos preencheram!</div>'
                                }
                            </div>
                        </div>
                    </div>
                    
                    <!-- Turma 2 -->
                    <div class="turma-alunos-box">
                        <div class="turma-alunos-title">📊 Turma 2 (${turma2Alunos.length} alunos)</div>
                        
                        <div class="turma-alunos-content">
                            <!-- Preenchidos -->
                            <div class="alunos-section">
                                <div class="alunos-section-title preenchidos">
                                    ✅ Preenchidos (${turma2Preenchidos.length})
                                </div>
                                ${turma2Preenchidos.length > 0 ? 
                                    turma2Preenchidos.map(aluno => `
                                        <div class="aluno-item">
                                            <div>${aluno.nomePreferido || aluno.nome}</div>
                                        </div>
                                    `).join('') 
                                    : '<div class="empty-list">Nenhum aluno preencheu</div>'
                                }
                            </div>
                            
                            <!-- Pendentes -->
                            <div class="alunos-section">
                                <div class="alunos-section-title pendentes">
                                    ⏳ Pendentes (${turma2Pendentes.length})
                                </div>
                                ${turma2Pendentes.length > 0 ? 
                                    turma2Pendentes.map(aluno => `
                                        <div class="aluno-item">
                                            <div>${aluno.nomePreferido || aluno.nome}</div>
                                        </div>
                                    `).join('')
                                    : '<div class="empty-list">Todos preencheram!</div>'
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function gerarInsights(analiseFormularios, gap, alunosRisco, alunosCem, todosAlunos) {
            let insights = '';
            
            // Insight sobre gap
            if (Math.abs(gap) > 30) {
                const turmaFrente = gap > 0 ? 'Turma 1' : 'Turma 2';
                insights += `
                    <div class="insight-box">
                        <h4>⚠️ Gap Significativo Entre Turmas</h4>
                        <p>A ${turmaFrente} está ${Math.abs(gap)}% à frente. Considere:</p>
                        <p>• Sessões de mentoria extras para a turma com menor desempenho</p>
                        <p>• Identificar dificuldades específicas</p>
                        <p>• Ajustar ritmo ou materiais de apoio</p>
                    </div>
                `;
            } else if (Math.abs(gap) > 15) {
                const turmaFrente = gap > 0 ? 'Turma 1' : 'Turma 2';
                insights += `
                    <div class="insight-box">
                        <h4>📊 Diferença Moderada Entre Turmas</h4>
                        <p>A ${turmaFrente} está ${Math.abs(gap)}% à frente. Gap aceitável, mas monitore a evolução.</p>
                    </div>
                `;
            }
            
            // Insight sobre alunos em risco
            if (alunosRisco > 0) {
                const percentRisco = Math.round((alunosRisco / todosAlunos.length) * 100);
                insights += `
                    <div class="insight-box">
                        <h4>⚠️ Alunos Sem Progresso</h4>
                        <p>${alunosRisco} alunos (${percentRisco}%) não iniciaram nenhum formulário.</p>
                        <p><strong>Ação recomendada:</strong> Contato individual urgente para entender barreiras.</p>
                    </div>
                `;
            }
            
            // Identificar formulário mais crítico
            const formCritico = analiseFormularios.reduce((min, curr, idx) => 
                curr.mediaGeral < min.mediaGeral ? {mediaGeral: curr.mediaGeral, idx} : min,
                {mediaGeral: 100, idx: 0}
            );
            
            if (formCritico.mediaGeral < 50) {
                insights += `
                    <div class="insight-box">
                        <h4>🎯 Formulário com Menor Adesão</h4>
                        <p><strong>${formularioNomes[formCritico.idx]}</strong> - apenas ${formCritico.mediaGeral}% de conclusão.</p>
                        <p><strong>Recomendação:</strong> Revisar dificuldade, clareza das instruções ou oferecer suporte adicional.</p>
                    </div>
                `;
            }
            
            // Celebração se houver muitos com 100%
            if (alunosCem > 0) {
                const percentCem = Math.round((alunosCem / todosAlunos.length) * 100);
                if (percentCem >= 20) {
                    insights += `
                        <div class="insight-box">
                            <h4>🎉 Excelente Engajamento!</h4>
                            <p>${alunosCem} alunos (${percentCem}%) completaram 100% dos formulários!</p>
                            <p>Continue o trabalho excelente com esse grupo.</p>
                        </div>
                    `;
                }
            }
            
            // Se não houver insights críticos, dar mensagem positiva
            if (insights === '') {
                insights = `
                    <div class="insight-box">
                        <h4>✅ Sistema Funcionando Bem</h4>
                        <p>Não há alertas críticos no momento. Continue monitorando o progresso regularmente.</p>
                    </div>
                `;
            }
            
            return insights;
        }

        function calcularMedia(alunos) {
            if (alunos.length === 0) return 0;
            const soma = alunos.reduce((acc, aluno) => {
                const prog = Math.round((aluno.formularios.filter(f => f.status === 'Preenchido').length / 6) * 100);
                return acc + prog;
            }, 0);
            return Math.round(soma / alunos.length);
        }

        // ==================== FUNÇÕES NOVAS DO MASTER ====================
        
        // FUNÇÃO COMBINADA: Estatísticas + Detalhamento em 1 Card Dinâmico
        function renderizarAnaliseFormularios() {
            return `
                <div class="analise-formularios-section">
                    <div class="analise-header">
                        <label for="selectFormulario">Selecione o Formulário:</label>
                        <select id="selectFormulario" class="select-formulario" onchange="atualizarAnaliseFormulario()">
                            <option value="0">Anamnese Geral + Visão de Futuro</option>
                            <option value="1">Jornada do Herói</option>
                            <option value="2">Escritor Best Seller</option>
                            <option value="3">Influenciador Digital</option>
                            <option value="4">Palestrante Poderoso</option>
                            <option value="5">Mentor High Ticket</option>
                        </select>
                    </div>
                    <div id="analiseFormularioContent"></div>
                </div>
            `;
        }

        function atualizarAnaliseFormulario() {
            const index = parseInt(document.getElementById('selectFormulario').value);
            const nomesFormularios = [
                'Anamnese Geral + Visão de Futuro',
                'Jornada do Herói',
                'Escritor Best Seller',
                'Influenciador Digital',
                'Palestrante Poderoso',
                'Mentor High Ticket'
            ];

            const turma1 = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2 = todosAlunos.filter(a => a.turma === 'TURMA 2');

            const t1Preenchidos = turma1.filter(a => a.formularios[index].status === 'Preenchido');
            const t1Pendentes = turma1.filter(a => a.formularios[index].status === 'Pendente');
            const t2Preenchidos = turma2.filter(a => a.formularios[index].status === 'Preenchido');
            const t2Pendentes = turma2.filter(a => a.formularios[index].status === 'Pendente');

            const t1Percent = Math.round((t1Preenchidos.length / turma1.length) * 100);
            const t2Percent = Math.round((t2Preenchidos.length / turma2.length) * 100);

            document.getElementById('analiseFormularioContent').innerHTML = `
                <div class="analise-stats">
                    <div class="analise-stat-turma">
                        <h4>TURMA 1</h4>
                        <div class="stat-big">${t1Preenchidos.length}/${turma1.length}</div>
                        <div class="stat-percent">${t1Percent}%</div>
                        <div class="progress-bar-large">
                            <div class="progress-fill-large" style="width: ${t1Percent}%"></div>
                        </div>
                    </div>
                    <div class="analise-stat-turma">
                        <h4>TURMA 2</h4>
                        <div class="stat-big">${t2Preenchidos.length}/${turma2.length}</div>
                        <div class="stat-percent">${t2Percent}%</div>
                        <div class="progress-bar-large">
                            <div class="progress-fill-large" style="width: ${t2Percent}%"></div>
                        </div>
                    </div>
                </div>

                <div class="analise-detalhes">
                    <div class="analise-coluna">
                        <h5>TURMA 1</h5>
                        <div class="analise-grupo">
                            <p class="grupo-title">✅ Preenchidos (${t1Preenchidos.length})</p>
                            <div class="chips-scroll">
                                ${t1Preenchidos.length > 0
                                    ? t1Preenchidos.map(a => `<span class="chip-nome">${a.nome}</span>`).join('')
                                    : '<span class="empty-msg">Nenhum aluno</span>'
                                }
                            </div>
                        </div>
                        <div class="analise-grupo">
                            <p class="grupo-title">⏳ Pendentes (${t1Pendentes.length})</p>
                            <div class="chips-scroll">
                                ${t1Pendentes.length > 0
                                    ? t1Pendentes.map(a => `<span class="chip-nome pendente">${a.nome}</span>`).join('')
                                    : '<span class="empty-msg">Todos preencheram! 🎉</span>'
                                }
                            </div>
                        </div>
                    </div>
                    <div class="analise-coluna">
                        <h5>TURMA 2</h5>
                        <div class="analise-grupo">
                            <p class="grupo-title">✅ Preenchidos (${t2Preenchidos.length})</p>
                            <div class="chips-scroll">
                                ${t2Preenchidos.length > 0
                                    ? t2Preenchidos.map(a => `<span class="chip-nome">${a.nome}</span>`).join('')
                                    : '<span class="empty-msg">Nenhum aluno</span>'
                                }
                            </div>
                        </div>
                        <div class="analise-grupo">
                            <p class="grupo-title">⏳ Pendentes (${t2Pendentes.length})</p>
                            <div class="chips-scroll">
                                ${t2Pendentes.length > 0
                                    ? t2Pendentes.map(a => `<span class="chip-nome pendente">${a.nome}</span>`).join('')
                                    : '<span class="empty-msg">Todos preencheram! 🎉</span>'
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // FUNÇÃO 1: Estatísticas por Formulário (ANTIGA - SERÁ REMOVIDA)
        function renderizarEstatisticasFormularios() {
            const nomesFormularios = [
                'Anamnese Geral + Visão de Futuro',
                'Jornada do Herói',
                'Escritor Best Seller',
                'Influenciador Digital',
                'Palestrante Poderoso',
                'Mentor High Ticket'
            ];

            return nomesFormularios.map((nomeForm, index) => {
                const turma1 = todosAlunos.filter(a => a.turma === 'TURMA 1');
                const turma2 = todosAlunos.filter(a => a.turma === 'TURMA 2');

                const t1Preenchidos = turma1.filter(a => a.formularios[index].status === 'Preenchido').length;
                const t2Preenchidos = turma2.filter(a => a.formularios[index].status === 'Preenchido').length;

                const t1Percent = Math.round((t1Preenchidos / turma1.length) * 100);
                const t2Percent = Math.round((t2Preenchidos / turma2.length) * 100);

                return `
                    <div class="form-stat-card">
                        <h4 class="form-stat-title">${nomeForm}</h4>
                        <div class="form-stat-grid">
                            <div class="form-stat-turma">
                                <div class="form-stat-label">TURMA 1</div>
                                <div class="form-stat-value">${t1Preenchidos}/${turma1.length}</div>
                                <div class="form-stat-percent">${t1Percent}%</div>
                                <div class="form-stat-bar">
                                    <div class="form-stat-fill" style="width: ${t1Percent}%"></div>
                                </div>
                            </div>
                            <div class="form-stat-turma">
                                <div class="form-stat-label">TURMA 2</div>
                                <div class="form-stat-value">${t2Preenchidos}/${turma2.length}</div>
                                <div class="form-stat-percent">${t2Percent}%</div>
                                <div class="form-stat-bar">
                                    <div class="form-stat-fill" style="width: ${t2Percent}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // FUNÇÃO 2: Detalhamento por Formulário
        function renderizarDetalhamentFormularios() {
            const nomesFormularios = [
                'Anamnese Geral + Visão de Futuro',
                'Jornada do Herói',
                'Escritor Best Seller',
                'Influenciador Digital',
                'Palestrante Poderoso',
                'Mentor High Ticket'
            ];

            return nomesFormularios.map((nomeForm, index) => {
                const turma1 = todosAlunos.filter(a => a.turma === 'TURMA 1');
                const turma2 = todosAlunos.filter(a => a.turma === 'TURMA 2');

                const t1Preenchidos = turma1.filter(a => a.formularios[index].status === 'Preenchido');
                const t1Pendentes = turma1.filter(a => a.formularios[index].status === 'Pendente');

                const t2Preenchidos = turma2.filter(a => a.formularios[index].status === 'Preenchido');
                const t2Pendentes = turma2.filter(a => a.formularios[index].status === 'Pendente');

                return `
                    <div class="form-detail-card">
                        <div class="form-detail-header" onclick="toggleFormDetail(this)">
                            <h4>📝 ${nomeForm}</h4>
                            <span class="expand-icon">▼</span>
                        </div>
                        <div class="form-detail-content">
                            <div class="form-detail-turmas">
                                <!-- TURMA 1 -->
                                <div class="form-detail-turma">
                                    <h5 class="turma-title">TURMA 1</h5>
                                    <div class="form-detail-section">
                                        <p class="section-title-small">✅ Preenchidos (${t1Preenchidos.length})</p>
                                        <div class="alunos-chips">
                                            ${t1Preenchidos.length > 0 
                                                ? t1Preenchidos.map(a => `
                                                    <span class="aluno-chip">${a.nome}</span>
                                                `).join('')
                                                : '<span class="empty-text">Nenhum aluno preencheu</span>'
                                            }
                                        </div>
                                    </div>
                                    <div class="form-detail-section">
                                        <p class="section-title-small">⏳ Pendentes (${t1Pendentes.length})</p>
                                        <div class="alunos-chips">
                                            ${t1Pendentes.length > 0
                                                ? t1Pendentes.map(a => `
                                                    <span class="aluno-chip pendente">${a.nome}</span>
                                                `).join('')
                                                : '<span class="empty-text">Todos preencheram! 🎉</span>'
                                            }
                                        </div>
                                    </div>
                                </div>

                                <!-- TURMA 2 -->
                                <div class="form-detail-turma">
                                    <h5 class="turma-title">TURMA 2</h5>
                                    <div class="form-detail-section">
                                        <p class="section-title-small">✅ Preenchidos (${t2Preenchidos.length})</p>
                                        <div class="alunos-chips">
                                            ${t2Preenchidos.length > 0
                                                ? t2Preenchidos.map(a => `
                                                    <span class="aluno-chip">${a.nome}</span>
                                                `).join('')
                                                : '<span class="empty-text">Nenhum aluno preencheu</span>'
                                            }
                                        </div>
                                    </div>
                                    <div class="form-detail-section">
                                        <p class="section-title-small">⏳ Pendentes (${t2Pendentes.length})</p>
                                        <div class="alunos-chips">
                                            ${t2Pendentes.length > 0
                                                ? t2Pendentes.map(a => `
                                                    <span class="aluno-chip pendente">${a.nome}</span>
                                                `).join('')
                                                : '<span class="empty-text">Todos preencheram! 🎉</span>'
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // FUNÇÃO 3: Distribuição de Arquétipos
        function renderizarDistribuicaoArquetipos() {
            const turma1 = todosAlunos.filter(a => a.turma === 'TURMA 1');
            const turma2 = todosAlunos.filter(a => a.turma === 'TURMA 2');

            function contarArquetipos(alunos) {
                const contagem = {};
                alunos.forEach(aluno => {
                    const arq = aluno.arquetipo && aluno.arquetipo.trim() !== '' && aluno.arquetipo !== 'Pendente' 
                        ? aluno.arquetipo 
                        : 'Sem arquétipo';
                    contagem[arq] = (contagem[arq] || 0) + 1;
                });
                return Object.entries(contagem).sort((a, b) => b[1] - a[1]);
            }

            const arquetiposT1 = contarArquetipos(turma1);
            const arquetiposT2 = contarArquetipos(turma2);

            return `
                <div class="arquetipos-grid">
                    <!-- TURMA 1 -->
                    <div class="arquetipo-turma-card">
                        <h4 class="arquetipo-turma-title">TURMA 1 (${turma1.length} alunos)</h4>
                        <div class="arquetipos-list">
                            ${arquetiposT1.map(([arq, count]) => {
                                const percent = Math.round((count / turma1.length) * 100);
                                return `
                                    <div class="arquetipo-item-stat">
                                        <div class="arquetipo-item-header">
                                            <span class="arquetipo-nome-stat">${arq}</span>
                                            <span class="arquetipo-count">${count} (${percent}%)</span>
                                        </div>
                                        <div class="arquetipo-bar">
                                            <div class="arquetipo-fill" style="width: ${percent}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- TURMA 2 -->
                    <div class="arquetipo-turma-card">
                        <h4 class="arquetipo-turma-title">TURMA 2 (${turma2.length} alunos)</h4>
                        <div class="arquetipos-list">
                            ${arquetiposT2.map(([arq, count]) => {
                                const percent = Math.round((count / turma2.length) * 100);
                                return `
                                    <div class="arquetipo-item-stat">
                                        <div class="arquetipo-item-header">
                                            <span class="arquetipo-nome-stat">${arq}</span>
                                            <span class="arquetipo-count">${count} (${percent}%)</span>
                                        </div>
                                        <div class="arquetipo-bar">
                                            <div class="arquetipo-fill" style="width: ${percent}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Função para toggle dos detalhes de formulário
        function toggleFormDetail(element) {
            const card = element.parentElement;
            card.classList.toggle('expanded');
        }

        function toggleAluno(element) {
            const card = element.parentElement;
            card.classList.toggle('expanded');
        }

        // ==================== INICIALIZAÇÃO ====================
        carregarDados();
    </script>
</body>
</html>
